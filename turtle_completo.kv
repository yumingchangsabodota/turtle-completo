#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#File name: turtle_completo.py
#:kivy 1.10.1

#manage screen names and ids
ScreenManagement:
	#screen name variables so the py codes can access widgets inside the screens
	onlyblockexplorerscreen:onlyblockexplorerscreen 
	onlyblocksearchscreen:onlyblocksearchscreen
    transition:SlideTransition()
    OnStartScreen:
        id:onstartscreen
        name: 'onstartscreen'
    OnOpenWalletScreen:
    WalletScreen:
    TransactionScreen:
    BlockExplorerWithWalletScreen:
        id:blockexplorerwithwalletscreen
        name:'blockexplorerwithwalletscreen'
    BlockSearchWithWalletScreen:
        id:blocksearchwithwalletscreen
        name: 'blocksearchwithwalletscreen'
    OnlyBlockExplorerScreen:
        id:onlyblockexplorerscreen
        name:'onlyblockexplorerscreen'
    OnlyBlockSearchScreen:
        id:onlyblocksearchscreen
        name: 'onlyblocksearchscreen'
    #SettingScreen:
    AboutScreen:
#_________________________________________some label properties____________________       
#invisible label for padding and design purposes    
<InvLabel@Label>:
    color: 0,1,0,1
    background_color:0,0,0,0
    halign:'center'
    valign:'center'
    text_size: self.size
	
#long label's properties
<LongLabelLabel@Label>:
	color: 1,1,1,0.8
	halign:'center'
	valign:'center'
	font_size: 15
	
#tableheader label general properties
<TableHeaderItem@Label>:
	color: 0,0,0,0.8
	halign:'center'
	valign:'center'
	font_size: 14

#table label general properties
<TableItem@Label>:
	color: 33/255,38/255,33/255,0.9
	halign:'center'
	valign:'center'
	font_size: 13


#_________________________________________some layout properties____________________	
#long label
<LongLabel@RelativeLayout>:
    size_hint:1,0.025
    canvas.before:
        Color:
            rgba: 0, 0, 0, 0.8
        Rectangle:
            size: self.size
			
#Recent tableheader layout
<RecentBlockTableHeader@RelativeLayout>:
    size_hint:1,0.025
    canvas.before:
        Color:
            rgba: 0.5, 0.5, 0.5, 0.8
        Rectangle:
            size: self.size
	TableHeaderItem:
		pos_hint:{"x":0,"y":0}
		size_hint:0.1,1
		text:"Height"
	TableHeaderItem:
		pos_hint:{"x":0.1,"y":0}
		size_hint:0.075,1
		text:"Size"
	TableHeaderItem:
		pos_hint:{"x":0.175,"y":0}
		size_hint:0.45,1
		text:"Block Hash"
	TableHeaderItem:
		pos_hint:{"x":0.625,"y":0}
		size_hint:0.1,1
		text:"Difficulty"
	TableHeaderItem:
		pos_hint:{"x":0.725,"y":0}
		size_hint:0.05,1
		text:"Tx"
	TableHeaderItem:
		pos_hint:{"x":0.775,"y":0}
		size_hint:0.225,1
		text:"Date & Time"
		
#Txpool tableheader layout
<TxPoolTableHeader@RelativeLayout>:
    size_hint:1,0.025
    canvas.before:
        Color:
            rgba: 0.5, 0.5, 0.5, 0.8
        Rectangle:
            size: self.size
	TableHeaderItem:
		pos_hint:{"x":0,"y":0}
		size_hint:0.15,1
		text:"Amount"
	TableHeaderItem:
		pos_hint:{"x":0.15,"y":0}
		size_hint:0.1,1
		text:"Fee"
	TableHeaderItem:
		pos_hint:{"x":0.25,"y":0}
		size_hint:0.1,1
		text:"Size"
	TableHeaderItem:
		pos_hint:{"x":0.35,"y":0}
		size_hint:0.65,1
		text:"Hash"	
			
#txpoolData layout
<TxPoolData>:
	size_hint_x: 1
	size_hint_y: None
	height: 25
	txp_amount:txp_amount
	txp_fee:txp_fee
	txp_size:txp_size
	txp_hash:txp_hash
	colors: (0.5, 0.5, 0.5, 0.3)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	TableItem:
		id:txp_amount
		name:"txp_amount"
		pos_hint:{"x":0,"y":0}
		size_hint:0.15,1

	TableItem:
		id:txp_fee
		name:"txp_fee"
		pos_hint:{"x":0.15,"y":0}
		size_hint:0.1,1

	TableItem:
		id:txp_size
		name:"txp_size"
		pos_hint:{"x":0.25,"y":0}
		size_hint:0.1,1

	TableItem:
		id:txp_hash
		name:"txp_hash"
		pos_hint:{"x":0.35,"y":0}
		size_hint:0.65,1

		
		
#recentblockData layout
<RecentBlockData>:
	size_hint_x: 1
	size_hint_y: None
	height: 25
	rctblk_height:rctblk_height
	rctblk_size:rctblk_size
	rctblk_hash:rctblk_hash
	rctblk_difficulty:rctblk_difficulty
	rctblk_tx:rctblk_tx
	rctblk_datetime:rctblk_datetime
	colors: (0.5, 0.5, 0.5, 0.3)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	TableItem:
		id:rctblk_height
		name:"rctblk_height"
		pos_hint:{"x":0,"y":0}
		size_hint:0.1,1
	TableItem:
		id:rctblk_size
		name:"rctblk_size"
		pos_hint:{"x":0.1,"y":0}
		size_hint:0.075,1
	TableItem:
		id:rctblk_hash
		name:"rctblk_hash"
		pos_hint:{"x":0.175,"y":0}
		size_hint:0.45,1
	TableItem:
		id:rctblk_difficulty
		name:"rctblk_difficulty"
		pos_hint:{"x":0.625,"y":0}
		size_hint:0.1,1
	TableItem:
		id:rctblk_tx
		name:"rctblk_tx"
		pos_hint:{"x":0.725,"y":0}
		size_hint:0.05,1
	TableItem:
		id:rctblk_datetime
		name:"rctblk_datetime"
		pos_hint:{"x":0.775,"y":0}
		size_hint:0.225,1
		
#---------------------------------
#BigLabel
<BigLabel>:
	size_hint: 1, None
	height : 30
	halign:'left'
	valign:'middle'
	text_size:self.width-30,self.height
	font_size: 24
	color:0,0,0,1
	markup: True
		
#SmallLabel
<SmallLabel>:
	size_hint: 1, None
	height : 25
	halign:'left'
	valign:'middle'
	text_size:self.width-30,self.height
	font_size: 13
	color:0,0,0,1
	markup: True

#BlkSearchData layout
<BlkSearchData>:
	blkResultItem1:blkResultItem1
	blkResultItem2:blkResultItem2
	size_hint_x: 1
	size_hint_y: None
	height: 25
	colors: (0.5, 0.5, 0.5, 0)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	SmallLabel:
		id:blkResultItem1
		size_hint:0.325,1
		pos_hint:{"x":0,"y":0}
	SmallLabel:
		id:blkResultItem2
		size_hint:0.675,1
		pos_hint:{"x":0.325,"y":0}
		
#Block search txs info
<BlkSearchTx>:
	tx_hash:tx_hash
	tx_fee:tx_fee
	tx_totalAmount:tx_totalAmount
	tx_Size:tx_Size
	size_hint_x: 1
	size_hint_y: None
	height: 25
	colors: (0.5, 0.5, 0.5, 0.3)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	Label:
		id: tx_hash
		pos_hint:{"x":0,"y":0}
		size_hint: 0.45, 1	
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
	Label:
		id: tx_fee
		pos_hint:{"x":0.45,"y":0}
		size_hint: 0.1, 1	
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
	Label:
		id: tx_totalAmount
		pos_hint:{"x":0.55,"y":0}
		size_hint: 0.15, 1	
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
	Label:
		id: tx_Size
		pos_hint:{"x":0.7,"y":0}
		size_hint: 0.3, 1	
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1

		
#TX Inputs layout		
<TXInputs>:
	input_amount:input_amount
	input_image:input_image
	size_hint_x: 1
	size_hint_y: None
	height: 25
	colors: (0.5, 0.5, 0.5, 0.3)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	Label:
		id: input_amount
		pos_hint:{"x":0,"y":0}
		size_hint: 0.25, 1	
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
	Label:
		id: input_image
		pos_hint:{"x":0.25,"y":0}
		size_hint: 0.75, 1
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
		
#TX Outputs layout		
<TXOutputs>:
	output_amount:output_amount
	output_key:output_key
	size_hint_x: 1
	size_hint_y: None
	height: 25
	colors: (0.5, 0.5, 0.5, 0.3)
	canvas.before:
		Color:
			rgba: self.colors
		Rectangle:
			size: self.size
	Label:
		id: output_amount
		pos_hint:{"x":0,"y":0}
		size: 0.25, 1
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
	Label:
		id: output_key
		pos_hint:{"x":0.25,"y":0}
		size: 0.75, 1
		halign:'left'
		valign:'middle'
		text_size:self.width-30,self.height
		font_size: 13
		color:0,0,0,1
		
#--------------------------------
   
#daemon status label
<StatusLabel>:
    pos_hint:{"x":0,"y":0.875}
    size_hint:0.1,0.125
    canvas.before:
        Color:
            rgba: 0, 0, 0, 0.7
        Rectangle:
            size: self.size
    Label:
		id:block_status_label
		name:"block_status_label"
        color: 1,1,0,0.8
        halign:'center'
        valign:'center'
        text_size: self.size
        text:app.status_text
		font_size: 13

#_________________________________________some button properties____________________    
#general button properties
<MyButton@Button>:
    color: 250/255,197/255,195/255,0.8
    background_color: (33/255,38/255,33/255,0.3) if self.state == 'normal' else (0.6,0,0.7,0.5)
    halign:'center'
    valign:'center'
    text_size: self.size
    bold:True
    
#buttons used in multiple pages
<ExitButton@MyButton>:
    id:exit
    text:"Exit"
	on_release: app.quitApp()
	
<AboutButton@MyButton>:
    id:about
    text:"About"
	on_release:app.show_popup()
	
#<SettingButton@MyButton>:
    #id:setting
    #text:"Setting"
	
<GoToWalletButton@MyButton>:
    id:gotowallet
    text:"Wallet"
	
<RecentBlocksButton@MyButton>:
    id:recentblocks
    text:"Blocks & Pool"
	on_release:app.root.current = "onlyblockexplorerscreen" 
	
<GoToSearchButton@MyButton>:
    id:gotosearch
    text:"Explore"
	on_release:app.root.current = "onlyblocksearchscreen"
	
<RecentBlocksButtonWallet@MyButton>:
    id:recentblocks
    text:"Blocks & Pool"
	on_release:app.root.current = "blockexplorerwithwalletscreen" 
	
<GoToSearchButtonWallet@MyButton>:
    id:gotosearch
    text:"Explore"
	on_release:app.root.current = "blocksearchwithwalletscreen"

<MyTxButton@MyButton>:
    id:mytx
    text:"My Tx"
	
<searchTxButton@MyButton>:
	id:searchtxbutton
	text: "Go"
	font_size: 14
	color: 1,1,0,0.8
	background_color: (33/255,38/255,33/255,1) if self.state == 'normal' else (0.6,0,0.7,1)

<searchBlkButton@MyButton>:
	id:searchBlkbutton
	text: "Go"
	font_size: 14
	color: 1,1,0,0.8
	background_color: (33/255,38/255,33/255,1) if self.state == 'normal' else (0.6,0,0.7,1)
#________________________________________________________________________________
#general side bar properties
<SideBar@BoxLayout>:
    pos_hint:{"x":0,"y":0}
    size_hint:0.1,0.875
    orientation: 'vertical'
    spacing: 0
    padding: 0
    canvas.before:
        Color:
            rgba: 33/255,38/255,33/255,0.3
        Rectangle:
            size: self.size
            
#app screen background
<BackGround@FloatLayout>:
    Widget:
        size:self.size
        pos:self.pos
        canvas.before:
            Rectangle:
                size:362,401
                pos:((root.width*0.5)-(362*0.5)),((root.height*0.5)-(401*0.5-50))
                source:'img/turtlecoin_icon_white@2x.png'
				
#________________________________Scroll View template______________________________________
<ScrollViewTemplate@ScrollView>:
	do_scroll_x:False
	canvas.before:
		Color:
			rgba: 0/255,133/255,61/255,0
			#rgba: 1,0,0,0.3
		Rectangle:
			size: self.size
			pos: self.pos
			
<DataListTemplate@GridLayout>:
	cols: 1
	size_hint: 1,None
	height: self.minimum_height
	
<TxSearchDisplay@GridLayout>:
	cols: 1
	size_hint: 1,None
	height: self.minimum_height

<BlkSearchDisplay@GridLayout>:
	cols: 1
	size_hint: 1,None
	height: self.minimum_height

		
#__________________________________________________About Popup____________________________

<AboutPopup>:
	size_hint: 0.5,0.5
	auto_dismiss: False
	title: "About Turtle Completo, version:0.1.0"
	FloatLayout:
		size_hint:1,1
		pos_hint:{"x":0,"y":0}
		TextInput:
			size_hint:1,0.9
			pos_hint:{"x":0,"y":0.1}
			multiline:True
			background_color: 0,0,0,0
			foreground_color: 1,1,1,1
			cursor_blink: False
			cursor_color: 0,0,0,0
			text: "Turtle Completo is a non-profitable community project written by Sabo (Revolutionary).\nIt is a local block explorer of the turtlecoin blockchain.\n\n\nSupport us with some TRTL:\n\nTRTLv1nQeHwinWcyxrPQSN3gdqxgKZqawZVJzQJ59Kwq45QvU9vafwG1bff2BecELJ3qaS16TeWEPW6UvxzxRd4u6D9wzUU5ERE\n\n\nBe a good TRTL and explore locally now!"
			readonly: True
			#text_size:self.width-25,self.height-10
		Button:
			size_hint:1,0.1
			pos_hint:{"x":0,"y":0}
			text: 'Close'	
			on_release: root.dismiss()
	
#__________________________________________________main____________________________________
#main app starts from here
<OnStartScreen>:
    BackGround:
        MyButton:
            id:turtlecompleto
            text:"Turtle Completo\n (under development)"
            pos_hint: {"x":0.18, "y":0.05}
            size_hint: 0.2,0.075
            #on_release:
                #app.root.transition.direction = 'right'
                #app.root.current = "blockexplorerwithwalletscreen"
                                
        MyButton:
            id:localexploreronly
            text:"Local Explorer Only"
            pos_hint: {"x":0.4, "y":0.05}
            size_hint: 0.2,0.075
            on_release:app.start_on_onlyblockexplorer()
             
        ExitButton:
            pos_hint: {"x":0.62, "y":0.05}
            size_hint: 0.2,0.075
			
#1       
<BlockExplorerWithWalletScreen>:
    BackGround:
        StatusLabel
        SideBar:
            GoToWalletButton
            MyTxButton
            RecentBlocksButtonWallet
            GoToSearchButtonWallet:
				on_release:
                    app.root.transition.direction = 'right'
            InvLabel
			InvLabel
			InvLabel
			InvLabel
            AboutButton
            #SettingButton
            ExitButton
        RelativeLayout:
            size_hint:0.9,1
            pos_hint: {"x":0.1,"y":0}
            canvas.before:
                Color:
                    rgba: 0, 0, 1, 0.5
                Rectangle:
                    size: self.size
			LongLabel:
				pos_hint:{"x":0,"y":0.975}
				LongLabelLabel:
					text:"Transaction Pool"		
			TxPoolTableHeader:
				pos_hint:{"x":0,"y":0.95}

			LongLabel:
				pos_hint:{"x":0,"y":0.55}
				LongLabelLabel:
					text:"Recent Blocks"
			RecentBlockTableHeader:
				pos_hint:{"x":0,"y":0.525}
#2					
<BlockSearchWithWalletScreen>:
    BackGround:
        StatusLabel
        SideBar:
            GoToWalletButton
            MyTxButton
            RecentBlocksButtonWallet:
				on_release:
                    app.root.transition.direction = 'left'
            GoToSearchButtonWallet
            InvLabel
			InvLabel
			InvLabel
			InvLabel
            AboutButton
            #SettingButton
            ExitButton
        RelativeLayout:
            size_hint:0.9,1
            pos_hint: {"x":0.1,"y":0}
            canvas:
                Color:
                    rgba: 0, 1, 1, 0.5
                Rectangle:
                    size: self.size
			LongLabel:
				pos_hint:{"x":0,"y":0.975}
				LongLabelLabel:
					text:"Look up Transaction"		
			LongLabel:
				pos_hint:{"x":0,"y":0.475}
				LongLabelLabel:
					text:"Dig into Block"

#3
<OnlyBlockExplorerScreen>:
	txp_datalistTemplate:txp_datalistTemplate
	rctblk_datalistTemplate:rctblk_datalistTemplate
    BackGround:
        StatusLabel
        SideBar:
            RecentBlocksButton
            GoToSearchButton:
				on_release:app.root.transition.direction = 'left'
            InvLabel
            InvLabel
			InvLabel
            InvLabel
			InvLabel
			InvLabel
            AboutButton
            #SettingButton
            ExitButton
					
        RelativeLayout:
            size_hint:0.9,1
            pos_hint: {"x":0.1,"y":0}
            canvas.before:
                Color:
                    rgba: 0, 0, 1, 0
                Rectangle:
                    size: self.size
			LongLabel:
				pos_hint:{"x":0,"y":0.975}
				LongLabelLabel:
					text:"Transaction Pool"
			TxPoolTableHeader:
				pos_hint:{"x":0,"y":0.95}
				
			ScrollViewTemplate:
				id:txp_scrollview
				size_hint:1,0.375
				pos_hint:{"x":0,"y":0.575}
				DataListTemplate:
					id:txp_datalistTemplate
					pos_hint:{'x':0,'y':0}

			LongLabel:
				pos_hint:{"x":0,"y":0.55}
				LongLabelLabel:
					text:"Recent Blocks"
			RecentBlockTableHeader:
				pos_hint:{"x":0,"y":0.525}
				
			ScrollViewTemplate:
				id:rctblk_scrollview
				size_hint:1,0.525
				pos_hint:{"x":0,"y":0}
				DataListTemplate:
					id:rctblk_datalistTemplate
					pos_hint:{'x':0,'y':0}

#4
<OnlyBlockSearchScreen>:
	txsearch_display:txsearch_display
	blksearch_display:blksearch_display
	searchTx_inputText:searchTx_inputText
	searchBlk_inputText:searchBlk_inputText
	searchblkbutton:searchblkbutton
	searchtxbutton:searchtxbutton
	
    BackGround:
        StatusLabel
        SideBar:
            RecentBlocksButton:
				on_release:app.root.transition.direction = 'right'
            GoToSearchButton
            InvLabel
			InvLabel
			InvLabel
			InvLabel
			InvLabel
			InvLabel
            AboutButton
            #SettingButton
            ExitButton
        RelativeLayout:
            size_hint:0.9,1
            pos_hint: {"x":0.1,"y":0}
            canvas:
                Color:
                    rgba: 0, 1, 1, 0
                Rectangle:
                    size: self.size
			LongLabel:
				pos_hint:{"x":0,"y":0.975}
				LongLabelLabel:
					text:"Find Transaction"
			ScrollViewTemplate:
				id:searchTx_scrollview
				size_hint: 1,0.475
				pos_hint:{"x":0,"y":0.5}
				TxSearchDisplay:
					id:txsearch_display
					pos_hint:{'x':0,'y':0}
			TextInput:
				id:searchTx_inputText
				multiline:False
				background_color: 250/255,197/255,195/255,0.5
				size_hint:0.425,0.035
				pos_hint:{"x":0.525,"y":0.5}
				font_size: 12
				hint_text: 'Transaction hash'
				hint_text_color: 0,0,0,0.4
				
			searchTxButton:
				id:searchtxbutton
				size_hint: 0.05,0.035
				pos_hint:{"x":0.95,"y":0.5}
				on_release:app.TxSchThread()
				
			LongLabel:
				pos_hint:{"x":0,"y":0.475}
				LongLabelLabel:
					text:"Check Block"
			ScrollViewTemplate:
				id:search_blk_scrollview
				size_hint:1,0.475
				pos_hint:{"x":0,"y":0}
				BlkSearchDisplay:
					id:blksearch_display
					pos_hint:{'x':0,'y':0}
			TextInput:
				id:searchBlk_inputText
				multiline:False
				background_color: 250/255,197/255,195/255,0.5
				size_hint:0.425,0.035
				pos_hint:{"x":0.525,"y":0}
				font_size: 12
				hint_text: 'Block hash, or block height'
				hint_text_color: 0,0,0,0.4
			searchBlkButton:
				id:searchblkbutton
				size_hint: 0.05,0.035
				pos_hint:{"x":0.95,"y":0}
				on_release:app.BlkSchThread()
				
					
